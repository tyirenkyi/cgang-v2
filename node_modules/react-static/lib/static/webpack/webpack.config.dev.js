"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = _default;

var _toConsumableArray2 = _interopRequireDefault(require("@babel/runtime/helpers/toConsumableArray"));

var _webpack = _interopRequireDefault(require("webpack"));

var _resolveFrom = _interopRequireDefault(require("resolve-from"));

var _htmlWebpackPlugin = _interopRequireDefault(require("html-webpack-plugin"));

var _caseSensitivePathsWebpackPlugin = _interopRequireDefault(require("case-sensitive-paths-webpack-plugin"));

var _extractCssChunksWebpackPlugin = _interopRequireDefault(require("extract-css-chunks-webpack-plugin"));

var _path = _interopRequireDefault(require("path"));

var _rules = _interopRequireDefault(require("./rules"));

function _default(_ref) {
  var config = _ref.config;
  var _config$paths = config.paths,
      DIST = _config$paths.DIST,
      NODE_MODULES = _config$paths.NODE_MODULES,
      SRC = _config$paths.SRC,
      HTML_TEMPLATE = _config$paths.HTML_TEMPLATE;
  process.env.REACT_STATIC_BASE_PATH = config.basePath;
  process.env.REACT_STATIC_PUBLIC_PATH = config.publicPath;
  process.env.REACT_STATIC_ASSETS_PATH = config.assetsPath;
  return {
    mode: 'development',
    optimization: {
      noEmitOnErrors: true,
      concatenateModules: true
    },
    context: _path["default"].resolve(__dirname, '../../../node_modules'),
    entry: ['react-hot-loader/patch'].concat((0, _toConsumableArray2["default"])(config.disableRuntime ? [] : [require.resolve('../../bootstrapPlugins'), require.resolve('../../bootstrapTemplates')]), [config.entry]).filter(Boolean),
    output: {
      filename: '[name].js',
      // never hash dev code
      chunkFilename: 'templates/[name].js',
      path: DIST,
      publicPath: process.env.REACT_STATIC_ASSETS_PATH || '/'
    },
    module: {
      rules: (0, _rules["default"])({
        config: config,
        stage: 'dev'
      }),
      strictExportPresence: true
    },
    resolve: {
      modules: [NODE_MODULES, SRC, DIST].concat((0, _toConsumableArray2["default"])([NODE_MODULES, SRC, DIST].map(function (d) {
        return _path["default"].resolve(__dirname, d);
      })), ['node_modules']),
      extensions: ['.wasm', '.mjs', '.js', '.json', '.jsx'],
      alias: {
        react$: (0, _resolveFrom["default"])(NODE_MODULES, 'react'),
        'react-dom$': (0, _resolveFrom["default"])(NODE_MODULES, 'react-dom'),
        // This is here so HMR modules use the same emitter instance.
        // Likely this is only needed for locally linked dev on RS, but still...
        'webpack/hot/emitter': (0, _resolveFrom["default"])(__dirname, 'webpack/hot/emitter')
      }
    },
    plugins: [new _webpack["default"].EnvironmentPlugin(process.env), new _htmlWebpackPlugin["default"]({
      inject: true,
      template: "!!raw-loader!".concat(HTML_TEMPLATE)
    }), new _webpack["default"].HotModuleReplacementPlugin(), new _webpack["default"].NamedModulesPlugin(), new _caseSensitivePathsWebpackPlugin["default"](), new _extractCssChunksWebpackPlugin["default"]({
      filename: '[name].css'
    })],
    devtool: 'cheap-module-source-map'
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9zdGF0aWMvd2VicGFjay93ZWJwYWNrLmNvbmZpZy5kZXYuanMiXSwibmFtZXMiOlsiY29uZmlnIiwicGF0aHMiLCJESVNUIiwiTk9ERV9NT0RVTEVTIiwiU1JDIiwiSFRNTF9URU1QTEFURSIsInByb2Nlc3MiLCJlbnYiLCJSRUFDVF9TVEFUSUNfQkFTRV9QQVRIIiwiYmFzZVBhdGgiLCJSRUFDVF9TVEFUSUNfUFVCTElDX1BBVEgiLCJwdWJsaWNQYXRoIiwiUkVBQ1RfU1RBVElDX0FTU0VUU19QQVRIIiwiYXNzZXRzUGF0aCIsIm1vZGUiLCJvcHRpbWl6YXRpb24iLCJub0VtaXRPbkVycm9ycyIsImNvbmNhdGVuYXRlTW9kdWxlcyIsImNvbnRleHQiLCJwYXRoIiwicmVzb2x2ZSIsIl9fZGlybmFtZSIsImVudHJ5IiwiZGlzYWJsZVJ1bnRpbWUiLCJyZXF1aXJlIiwiZmlsdGVyIiwiQm9vbGVhbiIsIm91dHB1dCIsImZpbGVuYW1lIiwiY2h1bmtGaWxlbmFtZSIsIm1vZHVsZSIsInJ1bGVzIiwic3RhZ2UiLCJzdHJpY3RFeHBvcnRQcmVzZW5jZSIsIm1vZHVsZXMiLCJtYXAiLCJkIiwiZXh0ZW5zaW9ucyIsImFsaWFzIiwicmVhY3QkIiwicGx1Z2lucyIsIndlYnBhY2siLCJFbnZpcm9ubWVudFBsdWdpbiIsIkh0bWxXZWJwYWNrUGx1Z2luIiwiaW5qZWN0IiwidGVtcGxhdGUiLCJIb3RNb2R1bGVSZXBsYWNlbWVudFBsdWdpbiIsIk5hbWVkTW9kdWxlc1BsdWdpbiIsIkNhc2VTZW5zaXRpdmVQYXRoc1BsdWdpbiIsIkV4dHJhY3RDc3NDaHVua3MiLCJkZXZ0b29sIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUVBOztBQUVlLHdCQUFxQjtBQUFBLE1BQVZBLE1BQVUsUUFBVkEsTUFBVTtBQUFBLHNCQUNpQkEsTUFBTSxDQUFDQyxLQUR4QjtBQUFBLE1BQzFCQyxJ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LENBQXFCO0FBQUVyQixNQUFBQSxRQUFRLEVBQUU7QUFBWixLQUFyQixDQVRPLENBNUNKO0FBdURMc0IsSUFBQUEsT0FBTyxFQUFFO0FBdkRKLEdBQVA7QUF5REQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgd2VicGFjayBmcm9tICd3ZWJwYWNrJ1xyXG5pbXBvcnQgcmVzb2x2ZUZyb20gZnJvbSAncmVzb2x2ZS1mcm9tJ1xyXG5pbXBvcnQgSHRtbFdlYnBhY2tQbHVnaW4gZnJvbSAnaHRtbC13ZWJwYWNrLXBsdWdpbidcclxuaW1wb3J0IENhc2VTZW5zaXRpdmVQYXRoc1BsdWdpbiBmcm9tICdjYXNlLXNlbnNpdGl2ZS1wYXRocy13ZWJwYWNrLXBsdWdpbidcclxuaW1wb3J0IEV4dHJhY3RDc3NDaHVua3MgZnJvbSAnZXh0cmFjdC1jc3MtY2h1bmtzLXdlYnBhY2stcGx1Z2luJ1xyXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJ1xyXG5cclxuaW1wb3J0IHJ1bGVzIGZyb20gJy4vcnVsZXMnXHJcblxyXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbih7IGNvbmZpZyB9KSB7XHJcbiAgY29uc3QgeyBESVNULCBOT0RFX01PRFVMRVMsIFNSQywgSFRNTF9URU1QTEFURSB9ID0gY29uZmlnLnBhdGhzXHJcblxyXG4gIHByb2Nlc3MuZW52LlJFQUNUX1NUQVRJQ19CQVNFX1BBVEggPSBjb25maWcuYmFzZVBhdGhcclxuICBwcm9jZXNzLmVudi5SRUFDVF9TVEFUSUNfUFVCTElDX1BBVEggPSBjb25maWcucHVibGljUGF0aFxyXG4gIHByb2Nlc3MuZW52LlJFQUNUX1NUQVRJQ19BU1NFVFNfUEFUSCA9IGNvbmZpZy5hc3NldHNQYXRoXHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBtb2RlOiAnZGV2ZWxvcG1lbnQnLFxyXG4gICAgb3B0aW1pemF0aW9uOiB7XHJcbiAgICAgIG5vRW1pdE9uRXJyb3JzOiB0cnVlLFxyXG4gICAgICBjb25jYXRlbmF0ZU1vZHVsZXM6IHRydWUsXHJcbiAgICB9LFxyXG4gICAgY29udGV4dDogcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uLy4uLy4uL25vZGVfbW9kdWxlcycpLFxyXG4gICAgZW50cnk6IFtcclxuICAgICAgJ3JlYWN0LWhvdC1sb2FkZXIvcGF0Y2gnLFxyXG4gICAgICAuLi4oY29uZmlnLmRpc2FibGVSdW50aW1lXHJcbiAgICAgICAgPyBbXVxyXG4gICAgICAgIDogW1xyXG4gICAgICAgICAgICByZXF1aXJlLnJlc29sdmUoJy4uLy4uL2Jvb3RzdHJhcFBsdWdpbnMnKSxcclxuICAgICAgICAgICAgcmVxdWlyZS5yZXNvbHZlKCcuLi8uLi9ib290c3RyYXBUZW1wbGF0ZXMnKSxcclxuICAgICAgICAgIF0pLFxyXG4gICAgICBjb25maWcuZW50cnksXHJcbiAgICBdLmZpbHRlcihCb29sZWFuKSxcclxuICAgIG91dHB1dDoge1xyXG4gICAgICBmaWxlbmFtZTogJ1tuYW1lXS5qcycsIC8vIG5ldmVyIGhhc2ggZGV2IGNvZGVcclxuICAgICAgY2h1bmtGaWxlbmFtZTogJ3RlbXBsYXRlcy9bbmFtZV0uanMnLFxyXG4gICAgICBwYXRoOiBESVNULFxyXG4gICAgICBwdWJsaWNQYXRoOiBwcm9jZXNzLmVudi5SRUFDVF9TVEFUSUNfQVNTRVRTX1BBVEggfHwgJy8nLFxyXG4gICAgfSxcclxuICAgIG1vZHVsZToge1xyXG4gICAgICBydWxlczogcnVsZXMoeyBjb25maWcsIHN0YWdlOiAnZGV2JyB9KSxcclxuICAgICAgc3RyaWN0RXhwb3J0UHJlc2VuY2U6IHRydWUsXHJcbiAgICB9LFxyXG4gICAgcmVzb2x2ZToge1xyXG4gICAgICBtb2R1bGVzOiBbXHJcbiAgICAgICAgTk9ERV9NT0RVTEVTLFxyXG4gICAgICAgIFNSQyxcclxuICAgICAgICBESVNULFxyXG4gICAgICAgIC4uLltOT0RFX01PRFVMRVMsIFNSQywgRElTVF0ubWFwKGQgPT4gcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgZCkpLFxyXG4gICAgICAgICdub2RlX21vZHVsZXMnLFxyXG4gICAgICBdLFxyXG4gICAgICBleHRlbnNpb25zOiBbJy53YXNtJywgJy5tanMnLCAnLmpzJywgJy5qc29uJywgJy5qc3gnXSxcclxuICAgICAgYWxpYXM6IHtcclxuICAgICAgICByZWFjdCQ6IHJlc29sdmVGcm9tKE5PREVfTU9EVUxFUywgJ3JlYWN0JyksXHJcbiAgICAgICAgJ3JlYWN0LWRvbSQnOiByZXNvbHZlRnJvbShOT0RFX01PRFVMRVMsICdyZWFjdC1kb20nKSxcclxuICAgICAgICAvLyBUaGlzIGlzIGhlcmUgc28gSE1SIG1vZHVsZXMgdXNlIHRoZSBzYW1lIGVtaXR0ZXIgaW5zdGFuY2UuXHJcbiAgICAgICAgLy8gTGlrZWx5IHRoaXMgaXMgb25seSBuZWVkZWQgZm9yIGxvY2FsbHkgbGlua2VkIGRldiBvbiBSUywgYnV0IHN0aWxsLi4uXHJcbiAgICAgICAgJ3dlYnBhY2svaG90L2VtaXR0ZXInOiByZXNvbHZlRnJvbShfX2Rpcm5hbWUsICd3ZWJwYWNrL2hvdC9lbWl0dGVyJyksXHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgcGx1Z2luczogW1xyXG4gICAgICBuZXcgd2VicGFjay5FbnZpcm9ubWVudFBsdWdpbihwcm9jZXNzLmVudiksXHJcbiAgICAgIG5ldyBIdG1sV2VicGFja1BsdWdpbih7XHJcbiAgICAgICAgaW5qZWN0OiB0cnVlLFxyXG4gICAgICAgIHRlbXBsYXRlOiBgISFyYXctbG9hZGVyISR7SFRNTF9URU1QTEFURX1gLFxyXG4gICAgICB9KSxcclxuICAgICAgbmV3IHdlYnBhY2suSG90TW9kdWxlUmVwbGFjZW1lbnRQbHVnaW4oKSxcclxuICAgICAgbmV3IHdlYnBhY2suTmFtZWRNb2R1bGVzUGx1Z2luKCksXHJcbiAgICAgIG5ldyBDYXNlU2Vuc2l0aXZlUGF0aHNQbHVnaW4oKSxcclxuICAgICAgbmV3IEV4dHJhY3RDc3NDaHVua3MoeyBmaWxlbmFtZTogJ1tuYW1lXS5jc3MnIH0pLCAvLyBuZXZlciBoYXNoIGRldiBjb2RlXHJcbiAgICBdLFxyXG4gICAgZGV2dG9vbDogJ2NoZWFwLW1vZHVsZS1zb3VyY2UtbWFwJyxcclxuICB9XHJcbn1cclxuIl19