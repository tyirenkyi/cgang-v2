"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
var _exportNames = {
  ChalkColor: true,
  findAvailablePort: true,
  time: true,
  timeEnd: true,
  debounce: true,
  escapeRegExp: true,
  progress: true
};
exports.time = time;
exports.timeEnd = timeEnd;
exports.debounce = debounce;
exports.escapeRegExp = escapeRegExp;
Object.defineProperty(exports, "progress", {
  enumerable: true,
  get: function get() {
    return _progress["default"];
  }
});
exports.findAvailablePort = exports.ChalkColor = void 0;

var _portfinder = _interopRequireDefault(require("portfinder"));

var _perf_hooks = require("perf_hooks");

var _utils = require("../browser/utils");

Object.keys(_utils).forEach(function (key) {
  if (key === "default" || key === "__esModule") return;
  if (Object.prototype.hasOwnProperty.call(_exportNames, key)) return;
  Object.defineProperty(exports, key, {
    enumerable: true,
    get: function get() {
      return _utils[key];
    }
  });
});

var _progress = _interopRequireDefault(require("./progress"));

//
// Export all shared utils
var ChalkColor = {
  yarn: '#2c8ebb',
  npm: '#cb3837'
};
exports.ChalkColor = ChalkColor;

var findAvailablePort = function findAvailablePort(start) {
  return _portfinder["default"].getPortPromise({
    port: start,
    stopPort: start + 1000
  });
};

exports.findAvailablePort = findAvailablePort;
var times = {};

function time(message) {
  times[message] = _perf_hooks.performance.now() / 1000;
}

function timeEnd(message) {
  if (times[message]) {
    var seconds = (_perf_hooks.performance.now() / 1000 - times[message]) * 10;
    times[message] = null;

    if (seconds < 0.1) {
      console.log("".concat(message));
      return;
    }

    if (seconds < 1) {
      seconds = Math.round(seconds * 10) / 10;
    } else {
      seconds = Math.round(seconds) / 10;
    }

    console.log("".concat(message, " (").concat(seconds, "s)"));
  }
}

function debounce(func, wait, immediate) {
  var timeout;
  return function () {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var later = function later() {
      timeout = null;
      if (!immediate) func.apply(void 0, args);
    };

    var callNow = immediate && !timeout;
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
    if (callNow) func.apply(void 0, args);
  };
}

var escapeReg = /[\\^$.*+?()[\]{}|]/g;

function escapeRegExp(str) {
  return str.replace(escapeReg, '\\$&');
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9pbmRleC5qcyJdLCJuYW1lcyI6WyJDaGFsa0NvbG9yIiwieWFybiIsIm5wbSIsImZpbmRBdmFpbGFibGVQb3J0Iiwic3RhcnQiLCJQb3J0RmluZGVyIiwiZ2V0UG9ydFByb21pc2UiLCJwb3J0Iiwic3RvcFBvcnQiLCJ0aW1lcyIsInRpbWUiLCJtZXNzYWdlIiwicGVyZm9ybWFuY2UiLCJub3ciLCJ0aW1lRW5kIiwic2Vjb25kcyIsImNvbnNvbGUiLCJsb2ciLCJNYXRoIiwicm91bmQiLCJkZWJvdW5jZSIsImZ1bmMiLCJ3YWl0IiwiaW1tZWRpYXRlIiwidGltZW91dCIsImFyZ3MiLCJsYXRlciIsImNhbGxOb3ciLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwiZXNjYXBlUmVnIiwiZXNjYXBlUmVnRXhwIiwic3RyIiwicmVwbGFjZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBOztBQUNBOztBQUlBOztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQUVBOztBQUxBO0FBRUE7QUFJTyxJQUFNQSxVQUFVLEdBQUc7QUFDeEJDLEVBQUFBLElBQUksRUFBRSxTQURrQjtBQUV4QkMsRUFBQUEsR0FBRyxFQUFFO0FBRm1CLENBQW5COzs7QUFLQSxJQUFNQyxpQkFBaUIsR0FBRyxTQUFwQkEsaUJBQW9CLENBQUFDLEtBQUs7QUFBQSxTQUNwQ0MsdUJBQVdDLGNBQVgsQ0FBMEI7QUFDeEJDLElBQUFBLElBQUksRUFBRUgsS0FEa0I7QUFFeEJJLElBQUFBLFFBQVEsRUFBRUosS0FBSyxHQUFHO0FBRk0sR0FBMUIsQ0FEb0M7QUFBQSxDQUEvQjs7O0FBTVAsSUFBTUssS0FBSyxHQUFHLEVBQWQ7O0FBQ08sU0FBU0MsSUFBVCxDQUFjQyxPQUFkLEVBQXVCO0FBQzVCRixFQUFBQSxLQUFLLENBQUNFLE9BQUQsQ0FBTCxHQUFpQkMsd0JBQVlDLEdBQVosS0FBb0IsSUFBckM7QUFDRDs7QUFDTSxTQUFTQyxPQUFULENBQWlCSCxPQUFqQixFQUEwQjtBQUMvQixNQUFJRixLQUFLLENBQUNFLE9BQUQsQ0FBVCxFQUFvQjtBQUNsQixRQUFJSSxPQUFPLEdBQUcsQ0FBQ0gsd0JBQVlDLEdBQVosS0FBb0IsSUFBcEIsR0FBMkJKLEtBQUssQ0FBQ0UsT0FBRCxDQUFqQyxJQUE4QyxFQUE1RDtBQUNBRixJQUFBQSxLQUFLLENBQUNFLE9BQUQsQ0FBTCxHQUFpQixJQUFqQjs7QUFFQSxRQUFJSSxPQUFPLEdBQUcsR0FBZCxFQUFtQjtBQUNqQkMsTUFBQUEsT0FBTyxDQUFDQyxHQUFSLFdBQWVOLE9BQWY7QUFDQTtBQUNEOztBQUVELFFBQUlJLE9BQU8sR0FBRyxDQUFkLEVBQWlCO0FBQ2ZBLE1BQUFBLE9BQU8sR0FBR0csSUFBSSxDQUFDQyxLQUFMLENBQVdKLE9BQU8sR0FBRyxFQUFyQixJQUEyQixFQUFyQztBQUNELEtBRkQsTUFFTztBQUNMQSxNQUFBQSxPQUFPLEdBQUdHLElBQUksQ0FBQ0MsS0FBTCxDQUFXSixPQUFYLElBQXNCLEVBQWhDO0FBQ0Q7O0FBQ0RDLElBQUFBLE9BQU8sQ0FBQ0MsR0FBUixXQUFlTixPQUFmLGVBQTJCSSxPQUEzQjtBQUNEO0FBQ0Y7O0FBRU0sU0FBU0ssUUFBVCxDQUFrQkMsSUFBbEIsRUFBd0JDLElBQXhCLEVBQThCQyxTQUE5QixFQUF5QztBQUM5QyxNQUFJQyxPQUFKO0FBQ0EsU0FBTyxZQUFhO0FBQUEsc0NBQVRDLElBQVM7QUFBVEEsTUFBQUEsSUFBUztBQUFBOztBQUNsQixRQUFNQyxLQUFLLEdBQUcsU0FBUkEsS0FBUSxHQUFNO0FBQ2xCRixNQUFBQSxPQUFPLEdBQUcsSUFBVjtBQUNBLFVBQUksQ0FBQ0QsU0FBTCxFQUFnQkYsSUFBSSxNQUFKLFNBQVFJLElBQVI7QUFDakIsS0FIRDs7QUFJQSxRQUFNRSxPQUFPLEdBQUdKLFNBQVMsSUFBSSxDQUFDQyxPQUE5QjtBQUNBSSxJQUFBQSxZQUFZLENBQUNKLE9BQUQsQ0FBWjtBQUNBQSxJQUFBQSxPQUFPLEdBQUdLLFVBQVUsQ0FBQ0gsS0FBRCxFQUFRSixJQUFSLENBQXBCO0FBQ0EsUUFBSUssT0FBSixFQUFhTixJQUFJLE1BQUosU0FBUUksSUFBUjtBQUNkLEdBVEQ7QUFVRDs7QUFFRCxJQUFNSyxTQUFTLEdBQUcscUJBQWxCOztBQUNPLFNBQVNDLFlBQVQsQ0FBc0JDLEdBQXRCLEVBQTJCO0FBQ2hDLFNBQU9BLEdBQUcsQ0FBQ0MsT0FBSixDQUFZSCxTQUFaLEVBQXVCLE1BQXZCLENBQVA7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBQb3J0RmluZGVyIGZyb20gJ3BvcnRmaW5kZXInXHJcbmltcG9ydCB7IHBlcmZvcm1hbmNlIH0gZnJvbSAncGVyZl9ob29rcydcclxuLy9cclxuXHJcbi8vIEV4cG9ydCBhbGwgc2hhcmVkIHV0aWxzXHJcbmV4cG9ydCAqIGZyb20gJy4uL2Jyb3dzZXIvdXRpbHMnXHJcblxyXG5leHBvcnQgeyBkZWZhdWx0IGFzIHByb2dyZXNzIH0gZnJvbSAnLi9wcm9ncmVzcydcclxuZXhwb3J0IGNvbnN0IENoYWxrQ29sb3IgPSB7XHJcbiAgeWFybjogJyMyYzhlYmInLFxyXG4gIG5wbTogJyNjYjM4MzcnLFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZmluZEF2YWlsYWJsZVBvcnQgPSBzdGFydCA9PlxyXG4gIFBvcnRGaW5kZXIuZ2V0UG9ydFByb21pc2Uoe1xyXG4gICAgcG9ydDogc3RhcnQsXHJcbiAgICBzdG9wUG9ydDogc3RhcnQgKyAxMDAwLFxyXG4gIH0pXHJcblxyXG5jb25zdCB0aW1lcyA9IHt9XHJcbmV4cG9ydCBmdW5jdGlvbiB0aW1lKG1lc3NhZ2UpIHtcclxuICB0aW1lc1ttZXNzYWdlXSA9IHBlcmZvcm1hbmNlLm5vdygpIC8gMTAwMFxyXG59XHJcbmV4cG9ydCBmdW5jdGlvbiB0aW1lRW5kKG1lc3NhZ2UpIHtcclxuICBpZiAodGltZXNbbWVzc2FnZV0pIHtcclxuICAgIGxldCBzZWNvbmRzID0gKHBlcmZvcm1hbmNlLm5vdygpIC8gMTAwMCAtIHRpbWVzW21lc3NhZ2VdKSAqIDEwXHJcbiAgICB0aW1lc1ttZXNzYWdlXSA9IG51bGxcclxuXHJcbiAgICBpZiAoc2Vjb25kcyA8IDAuMSkge1xyXG4gICAgICBjb25zb2xlLmxvZyhgJHttZXNzYWdlfWApXHJcbiAgICAgIHJldHVyblxyXG4gICAgfVxyXG5cclxuICAgIGlmIChzZWNvbmRzIDwgMSkge1xyXG4gICAgICBzZWNvbmRzID0gTWF0aC5yb3VuZChzZWNvbmRzICogMTApIC8gMTBcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlY29uZHMgPSBNYXRoLnJvdW5kKHNlY29uZHMpIC8gMTBcclxuICAgIH1cclxuICAgIGNvbnNvbGUubG9nKGAke21lc3NhZ2V9ICgke3NlY29uZHN9cylgKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xyXG4gIGxldCB0aW1lb3V0XHJcbiAgcmV0dXJuICguLi5hcmdzKSA9PiB7XHJcbiAgICBjb25zdCBsYXRlciA9ICgpID0+IHtcclxuICAgICAgdGltZW91dCA9IG51bGxcclxuICAgICAgaWYgKCFpbW1lZGlhdGUpIGZ1bmMoLi4uYXJncylcclxuICAgIH1cclxuICAgIGNvbnN0IGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXRcclxuICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KVxyXG4gICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpXHJcbiAgICBpZiAoY2FsbE5vdykgZnVuYyguLi5hcmdzKVxyXG4gIH1cclxufVxyXG5cclxuY29uc3QgZXNjYXBlUmVnID0gL1tcXFxcXiQuKis/KClbXFxde318XS9nXHJcbmV4cG9ydCBmdW5jdGlvbiBlc2NhcGVSZWdFeHAoc3RyKSB7XHJcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKGVzY2FwZVJlZywgJ1xcXFwkJicpXHJcbn1cclxuIl19